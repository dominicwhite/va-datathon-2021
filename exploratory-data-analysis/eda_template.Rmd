---
title: "Food Bank Distribution"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
datathon_df <- readRDS("../data/datathon.rds")
```

## Example ggplot graph

```{r}
datathon_df %>%
  ggplot() +
  geom_point(aes(census_B08201_001, census_B08201_002)) +
  labs(x = "Total households in county", y = "Households with no vehicles")
```

## Example choropleth map

```{r}
datathon_df %>%
  mutate(
    pct_no_vehicle = 100 * census_B08201_002 / census_B08201_001
  ) %>%
  ggplot() +
  geom_sf(aes(fill = pct_no_vehicle)) +
  labs(title = "% of households with no vehicle")
```

```{r}
datathon_df %>%
  st_drop_geometry() %>%
  select(census_NAME,FOOD_BANKS18) %>%
  arrange(desc(FOOD_BANKS18))
```
```{r}
datathon_df %>%
  ggplot() +
  geom_sf(aes(fill = FOOD_BANKS18)) +
  labs(title = "# of Federation of Virginia Food Banks in 2018")
```
Here is a graph that displays the amount of food banks in Virginia counties that are part of the Federation of Virginia Food Banks in the year 2018. Places highlighted and have food banks are Spotsylvania, Augusta, Hampton, Norfolk, Salem, and Richmond counties. 

We see here that the food banks are generally located around the center of Virginia rather than the perimeter. Overall, there is a very low number of food banks (Federation of Virginia Food Banks) (maximum being 1 in each county) within Virginia in 2018.

```{r}
datathon_df %>%
  st_drop_geometry() %>%
  select(census_NAME, census_S2201_C04_001)%>%
  arrange(desc(census_S2201_C04_001))
```
```{r}
datathon_df %>%
  ggplot() +
  geom_sf(aes(fill = census_S2201_C04_001)) +
  labs(title = "% of Virgina County Population that is on SNAP in 2017")
```
Here is a graph of counties' population percentages that are on SNAP in 2017. The higher SNAP population percentages (around 30%) are located near the bottom or rural areas of Virginia while the lower SNAP population percentages are located at the top or urban areas of Virginia. This can be due to external factors such as lower income due to less high-level job availability in the south and less food accessibility due to less food banks present.

```{r}
datathon_df %>%
  st_drop_geometry() %>%
  select(census_NAME, census_S2201_C04_021)%>%
  arrange(desc(census_S2201_C04_021))
```

```{r}
datathon_df %>%
  ggplot() +
  geom_sf(aes(fill = census_S2201_C04_021)) +
  labs(title = "% of Virgina County Households (At or Below the Poverty Level) on SNAP (in the past 12 months)")
```

This graph is the % of households that are at or below the poverty level that is on SNAP in the past 12 months. We see here that the concentration of at or below poverty level households that are on SNAP is in the southern counties such as Norton, Alleghany, and Cumberland. Comparing this with the first graph, we can take the case study of Norton city. Roughly 78.2% of all 'at or below the poverty line' households make up for 30% of the entire county's population.





